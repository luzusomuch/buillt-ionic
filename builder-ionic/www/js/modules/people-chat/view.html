<ion-view title="{{peopleChat.project.name}}">
    <ion-nav-back-button ng-click="$ionicGoBack($event)" class="button-icon icon ion-ios7-arrow-back">Back</ion-nav-back-button>
    <ion-nav-buttons side="right">
        <button ng-show="currentTab == 'task'" class="button button-clear icon-right ion-ios-plus-empty" ng-click="createNewTaskModal()"></button>
    </ion-nav-buttons>

    <!-- <ion-content padding="false" class="has-header"> -->
        <ion-tabs class="tabs-icon-top">
            <ion-tab ng-click="selectTabWithIndex(0)" title="Messages" icon="ion-ios7-chatboxes-outline">
                <div class="bar bar-subheader">
                    <div class="spacer" style="display: inline-block; width: 300px; height: 50px;"></div>
                    <form class="ng-pristine ng-valid" name="messageForm" novalidate ng-submit="sendMessage()" style="margin-top: 10px;">
                        <div class="item item-input">
                            <textarea style="width:80%" name="text" id="textarea1-board-chat" placeholder="Send a message ..." ng-model="message.text">
                            </textarea>
                            <button class="button button-stable button-block" type="submit" style="width:20%; margin-right:10px;" name="action">Send
                                <i class="mdi-content-send right"></i>
                            </button>
                        </div>
                        <div id="mentionPeople" class="col s12" ng-if="showPopup" style="position: fixed; height: 100px; width:200px; background-color:#64B5F6; overflow-y: auto">
                            <ul>
                                <li ng-click="getMentionValue(mention)" ng-repeat="mention in available | filter: mentionString">{{mention.name}}</li>
                            </ul>
                        </div>
                    </form>
                </div>
                <ion-content padding="false" class="has-header has-subheader messages-list-content">
                    <div class="spacer" style="display: inline-block; width: 300px; height: 90px;"></div>
                    <div class="list" scroll-to-bottom="board.orderedMessages">
                        <ion-item ng-repeat="message in board.orderedMessages">
                            <p style="font-size: 10px; color: #757575; margin-bottom: 0px">
                                <strong>{{message.user.name}}</strong><span style="font-size: 10px"> - {{message.sendAt | date : 'MMM d, y h:mm:ss a'}}.</span>
                            </p>
                            <p style="font-size: 13px; margin-top: 8px">
                                <span ng-bind-html="message.text | mention: message.mentions"></span>
                            </p>
                        </ion-item>
                    </div>
                </ion-content>
            </ion-tab>
            <ion-tab ng-click="selectTabWithIndex(1)" title="Tasks" icon="ion-ios7-checkmark-outline">
                <ion-content padding="false" class="has-header task-list-content">
                    <div class="spacer" style="display: inline-block; width: 300px; height: 90px;"></div>
                    <div class="list">
                        <ion-item ng-repeat="task in tasks" ui-sref="taskDetail({taskId: task._id})" ng-if="task.isOwner">
                            {{task.name}}
                        </ion-item>
                    </div>
                </ion-content>
            </ion-tab>
            <ion-tab ng-click="selectTabWithIndex(2)" title="Documents" icon="ion-ios-copy-outline">
                <ion-content padding="false" class="has-header task-list-content">
                    <div class="spacer" style="display: inline-block; width: 300px; height: 90px;"></div>
                    <div class="list">
                        <ion-item ng-repeat="file in files" ui-sref="fileDetail({fileId: file._id})" ng-if="file.isOwner">
                            {{file.title}}(Version: {{file.version + 1}})
                        </ion-item>
                    </div>
                </ion-content>
            </ion-tab>
        </ion-tabs>
        
    <!-- </ion-content> -->
</ion-view>
<script id="modalCreateTaskInPeople.html" type="text/ng-template">
    <div class="modal">
        <ion-header-bar class="bar-light">
            <h class="title">Create new task</h>
            <div class="buttons">
                <button ng-click="closeModal()" class="button button-stable button-icon button-large icon ion-ios7-checkmark-empty"></button>
            </div>
        </ion-header-bar>
        <ion-content padding="true" class="has-header">
            <form style="padding:10px;" id="createTaskForm" name="form" class="col s12" ng-submit="createNewTask(form)" novalidate>
            
                <div class="spacer" style="display: inline-block; width: 300px; height: 20px;"></div>
            
                <div class="item item-input">
                    <input placeholder="Task Description" id="task_description" type="text" ng-model="task.name" name="name" maxlength="80"
                       ng-class="{'invalid' : form.name.$invalid && submitted}" ng-disabled="isShow" required>
                    <p class="validate-message" ng-show="form.name.$error.required && submitted">Task name is required</p>
                </div>
            
                <div class="spacer" style="display: inline-block; width: 300px; height: 20px;"></div>
            
                <div class="item item-input">
                    <input ng-if="!isShowInputDate" id="showDueDate" type="text" placeholder="Due Date" ng-click="callDateInput()" ng-value="date">
                    <input ng-if="isShowInputDate" type="date" placeholder="Due Date"
                       name="created"
                       id="dueDate"
                       ng-model="task.dateEnd"
                       format="mm/dd/yyyy"
                       ng-disabled="isShow"
                    />
                </div>
            
                <div class="spacer" style="width: 300px; height: 44px;"></div>
            
                <div class="row" style="">
                    <button class="button button-positive button-outline button-block" type="submit" ng-if="!isShow" name="action">Add Task
                    </button>
                </div>
                <div class="spacer" style="width: 300px; height: 50px;"></div>
                <div class="row" style="display:none">
                    <button class="button button-stable button-block cancel-task" type="button" ng-click="cancelTask()">Cancel</button>
                </div>
            </form>
        </ion-content>
    </div>
</script>

