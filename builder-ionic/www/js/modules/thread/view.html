<ion-view title='{{thread.name}}'>
    <ion-nav-back-button ng-click="$ionicGoBack($event)" class="button-icon icon ion-ios7-arrow-back">Back</ion-nav-back-button>
	
    <div class="bar bar-subheader">
		
        <form class="ng-pristine ng-valid" name="messageForm" novalidate ng-submit="sendMessage()" style="margin-top: 10px;">
            <div class="item item-input remove-border">
                <textarea style="width:80%" name="text" id="textarea1" placeholder="Send a message ..." ng-model="message.text">
                </textarea>
                <button class="button button-calm button-clear button-stable button-block" type="submit" style="width:20%; margin-right:10px;" name="action">Send
                    <i class="mdi-content-send right"></i>
                </button>
            </div>
        </form>
		
    </div>
	
    <ion-content padding="false" class="has-header has-subheader">
        <div class="space" style="height:50px"></div>
        <div id="thread-detail-content">
            <div class="list">
                <ion-item class="item-text-wrap" ng-repeat="activity in thread.activities | orderBy: '-createdAt'">
                    <div class="activity-header">
                        <span class="activity-creator"><strong>{{(activity.user._id==currentUser._id) ? "You" : activity.user.name}}</strong></span>
                        <small ng-switch="activity.type">
                            <span ng-switch-when="chat">sent reply to this thread at {{activity.createdAt | date:'hh:mm a'}}, {{activity.createdAt |date:'dd-MM-yyyy'}}:</span>
                        
                            <span ng-switch-when="assign"> assigned the following people to this task at {{activity.createdAt | date:'hh:mm a'}}, {{activity.createdAt |date:'dd-MM-yyyy'}}:</span>
                        
                            <span ng-switch-when="insert-note"> added a note to this task at {{activity.createdAt | date:'hh:mm a'}}, {{activity.createdAt |date:'dd-MM-yyyy'}}:</span>
                        
                            <span ng-switch-when="archive"> archived this thread at {{activity.createdAt | date:'hh:mm a'}}, {{activity.createdAt |date:'dd-MM-yyyy'}}:</span>
                        
                            <span ng-switch-when="unarchive"> unarchived this thread at {{activity.createdAt | date:'hh:mm a'}}, {{activity.createdAt |date:'dd-MM-yyyy'}}:</span>
                        </small>
                    </div>
                    <div class="activity-body" ng-switch="activity.type">
                        <span ng-switch-when="chat" ng-bind-html="activity.element.message | htmlize"></span>
                        <span ng-switch-when="assign" >
                            <span ng-repeat="member in activity.element.invitees">{{member}}, </span>
                        </span>
                        <span ng-switch-when="insert-note" >
                            {{activity.element.content}}
                        </span>
                    </div>
                </ion-item>
                <ion-item>
                    <div class="activity-header">
                        {{(thread.owner._id==currentUser._id) ? "You" : thread.owner.name}} has created this thread at {{thread.createdAt | date: 'dd/MM/yyyy'}}
                    </div>
                </ion-item>
            </div>
        </div>

        <div class="space" style="height:50px"></div>
    </ion-content>
	
</ion-view>